{% extends "common/base.html" %}
{% block body %}
    <div class="row " >
        {#        <h1 class="text-center my-4">{{ stage.stage_name}} </h1>#}

        <div class="col-lg-12 mx-2 ">
            <div class="card" style="width:80%; height: 50%">
                <img src="{{ stage.Stage_image.url}}" class="card-img-top" alt="Stage image" width="" height="40%">
                <div class="card-body">
                    <h5 class="card-title text-center">{{ stage.stage_name}}</h5>
                    <hr style="color: #18d26e">
                    <p class="card-text">{{ stage.stage_description}}</p>

                    <p class="card-text text-danger">Click here to Vote your favorite Presentations out of all the presentation in this stage</p>
                    <a href="#" class="btn btn-secondary ">Vote </a>
                </div>
            </div>
        </div>
    </div>

    <div class="row my-3">
        <div class="col-12 ">
            <script>
                drawChart({{ data }})
            </script>
            <p id='review1_avg'class='must-be-hidden'>55</P>
            <p id='review2_avg' class='must-be-hidden'>55</P>
            <p id='review3_avg' class='must-be-hidden'>69</P>
            <!--Div that will hold the pie chart-->
            <div id="columnchart_values" style="width: 100%; height: 35%;"></div>
        </div>
    </div>


    <div class='row my-2'>
        <h1 class="text-center">Presentations</h1>

        <div class="col-10">
            {% for pres in presentations %}
                    {% if user == stage.user %}
            <div class="card mb-3" style="max-width: 540px;">
                <div class="row g-0">
                    
                  <div class="col-md-4">
                    <img src="..." class="img-fluid rounded-start" alt="...">
                  </div>
                  <div class="col-md-8">
                    <div class="card-body">
                      <h5 class="card-title"><a href="{% url 'detail_presentation' pres.id %}">{{ pres.pres_name }}</a></h5>
                      <p class="card-text">{{ pres.type }}</p>
                      <p class="card-text"><small class="text-muted">{{ pres.pres_date }}</small></p>
                      <p class="card-text"><small class="text-muted">{{ pres.owner }}</small></p>

                      <a href="{% url 'status' pres.id %}" class="btn btn-primary">{{ pres.approval }}</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
              {% elif pres.approval == "Approved" %}

            <div class="card mb-3" style="max-width: 540px;">
                <div class="row g-0">
                    
                  <div class="col-md-4">
                    <img src="..." class="img-fluid rounded-start" alt="...">
                  </div>
                  <div class="col-md-8">
                    <div class="card-body">
                      <h5 class="card-title"><a href="{% url 'detail_presentation' pres.id %}">{{ pres.pres_name }}</a></h5>
                      <p class="card-text">{{ pres.type }}</p>
                      <p class="card-text"><small class="text-muted">{{ pres.pres_date }}</small></p>
                      <p class="card-text"><small class="text-muted">{{ pres.owner }}</small></p>

                      <p class="">Available</p>
                    </div>
                  </div>
                </div>
              </div>
          
              {% elif user == pres.owner %}

             <div class="card mb-3" style="max-width: 540px;">
                <div class="row g-0">
                    
                  <div class="col-md-4">
                    <img src="..." class="img-fluid rounded-start" alt="...">
                  </div>
                  <div class="col-md-8">
                    <div class="card-body">
                      <h5 class="card-title"><a href="{% url 'detail_presentation' pres.id %}">{{ pres.pres_name }}</a></h5>
                      <p class="card-text">{{ pres.type }}</p>
                      <p class="card-text"><small class="text-muted">{{ pres.pres_date }}</small></p>
                      <p class="card-text"><small class="text-muted">{{ pres.owner }}</small></p>
                      {% if pres.approval == "Unapproved"%}
                      <p class="text-warning fw-bold">{{ pres.approval}}</p>
                      {% elif pres.approval == "Declined"%}
                      <p class="text-danger  fw-bold">{{ pres.approval}}</p>
                      {% else %}
                      <p class="text-success   fw-bold">{{ pres.approval}}</p>
                      {% endif %}
                      {% else %}
                      {% endif %}
                  {% endfor %}

                    </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>






        <div class='col-md-12 d-flex justify-content-center'>

            
            <table class="table  table-striped table-hover table-dark">
                <thead>
                <tr>
                    <th scope="col">Presentations</th>
                    <th scope="col">Type</th>
                    <th scope="col">Owner</th>
                    <th scope="col">Presentation Date</th>
                    <th scope="col">Status</th>
                </tr>
                </thead>
                <tbody class="table-hover ">
                {% for pres in presentations %}
                    {% if user == stage.user %}
                        <tr>
                            <th scope="row"><a href="{% url 'detail_presentation' pres.id %}">{{ pres.pres_name }} </a></th>
                            <td>{{ pres.type }}</td>
                            <td>{{ pres.owner }}</td>
                            <td>{{ pres.pres_date }}</td>
                            <td><a href="{% url 'status' pres.id %}">{{ pres.approval }}</a></td>
                        </tr>

                    {% elif pres.approval == "Approved" %}
                        <tr>
                            <th scope="row"><a href="{% url 'detail_presentation' pres.id %}">{{ pres.pres_name }} </a></th>
                            <td>{{ pres.type }}</td>
                            <td>{{ pres.owner }}</td>
                            <td>{{ pres.pres_date }}</td>
                            <td>Available</td>
                        </tr>




                    {% elif user == pres.owner %}
                        <tr>
                            <th scope="row"><a href="{% url 'detail_presentation' pres.id %}">{{ pres.pres_name }} </a></th>
                            <td>{{ pres.type }}</td>
                            <td>{{ pres.owner }}</td>
                            <td>{{ pres.pres_date }}</td>
                            {% if pres.approval == "Unapproved"%}
                            <td  class="text-warning fw-bold" >{{ pres.approval}}</td>
                            {% elif pres.approval == "Declined"%}
                            <td class="text-danger fw-bold">{{ pres.approval}}</td>
                            {% else %}
                            <td class="text-success fw-bold">{{ pres.approval}}</td>
                            {% endif %}
                            
                        </tr>

                    {% else %}
                    {% endif %}
                {% endfor %}

                </tbody>
            </table>


        </div>
    </div>





{% endblock %}